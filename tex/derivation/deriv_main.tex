%====================================================================
%                   PHYSICS
%====================================================================
\section{Physics of the problem}
We begin with the assumptions common to all study of fluid mechanics, that is that there is conservation of mass, of energy and of momentum. Furthermore we assume that our fluid (air, in this case) can be treated as a continuous body, so we have well-defined physical properties such as density, pressure and velocity.\par
%
With these, we move on to an assumption about air itself.\par
\begin{assumption}\label{assumption:no_viscosity}
  The viscosity of air at room temperature and pressure is negligible.
\end{assumption}
%
This is a fairly standard assumption to make for perturbations in air. The value of viscosity of air is in fact \emph{very} small compared to all other quantities. It is approximately equal to $0.175$ millipoise \cite[Table 333]{forsythe03tables} at standard temperature and pressure, or $1.75\times10^{-5} ~\si{kg.m^{-1}.s^{-1}}$.\par
%
Next we make an assumption about the forces which will come into play.
\begin{assumption}\label{assumption:no_external_forces}
  No forces act on the fluid.
\end{assumption}
%
Our problems will concern an incident plane wave scattering around an object. We will aim to find an expression for the result of this scattering alone so we won't need to consider external forces in this case. \par
%
The next two assumptions will help us define the relationship between pressure and density.
%
Consider the distinction between barotropic and baroclinic fluid flow. Naively, baroclinic fluid flow occurs when there is high variability. For example, where there are different air masses, cold and warm fronts or weather. In the problems we are going to consider this will not be the case -- our fluid flow will be barotropic.
\begin{defn} \parencite{shames02mechanics} A barotropic fluid is one where the density $\rho$ is expressible as a function of the pressure p only.
    \[ \rho = \rho(p)\]
\end{defn}
\begin{assumption}\label{assumption:barotropic}
  The fluid flow is barotropic.
\end{assumption}
%
Finally we consider Laplace's hypothesis, namely, that sound propagation occurs with negligible internal heat flow.
\begin{defn}\label{defn:adiabatic}
    A process is adiabatic if it satisfies Laplace's hypothesis.
\end{defn} \par
\begin{assumption}\label{assumption:adiabatic}
  Fluid flow in air is an adiabatic process.
\end{assumption}
%
This assumption has an important consequence. For an adiabatic process and a gas at constant pressure and volume, with constant specific heat coefficients per unit mass at constant temperature the following relationship holds:
\begin{equation}\label{eq:adiabatic_condition}
    p = K \rho ^ \gamma
\end{equation}
where $\gamma = c_p/c_v$ the specific heat ratio, and $K$ constant in time \parencite[$\S$1.4.1]{pierce19acoustics}. This will become relevant later.
%
%====================================================================
%                   GOVERNING EQUATIONS
%====================================================================
\section{Governing equations}\label{ss:governing_eqs}
We have assumed that our fluid flow is conservative and well defined at infinitesimal volume elemnets, so we can apply the Navier-Stokes equations. We use these equations to model the velocity field $\vec{u}$ of a fluid of density $\rho$ and viscosity $\mu$.
%
%-------------------- Navier-Stokes eqtns ----------------------------
%
\begin{equation}\label{eq:ns_momentum}
    \rho \frac{D \vec{u}}{D t} = \rho \vec{F} - \nabla p + \mu \nabla^2 \vec{u}
\end{equation}
\begin{equation}\label{eq:ns_continuity}
    \frac{D \rho}{D t} + \rho \nabla \cdot \vec{u} = 0
\end{equation}
Where $\nabla p$ is the pressure gradient within the fluid, $\vec{F}$ is the external force applied onto the fluid and $D/Dt$ is the material derivative,
  \[ \frac{D\vec{u}}{Dt} = \nabla \vec{u} + \partialfrac{\vec{u}}{t}.\] \par
%
Equation \eqref{eq:ns_momentum} is the momentum equation and \eqref{eq:ns_continuity} is the continutiy equation. By assumption \ref{assumption:no_viscosity} we can set $\mu = 0$. This gives the Euler momentum equation \parencite{shaughnessy05fluids}
\begin{equation}
    \rho \frac{D \vec{u}}{D t} = \rho \vec{F} - \nabla p.
\end{equation}
%
By assumption \ref{assumption:no_external_forces} we can set $\vec{F}$ to zero as well, yielding
    \begin{equation}\label{eq:euler_momentum}
        \partialfrac{\vec{u}}{t} + \vec{u} \cdot \nabla\vec{u} = - \frac{1}{\rho}\nabla p.
    \end{equation}
%
This, together with the continuity equation \eqref{eq:ns_continuity} are the governing equations for our velocity field.
%
%====================================================================
%                   PERTURBATION -> LIN WAVE EQTN
%====================================================================
%-------------- describing the perturbed state ------------------
\section{The linear wave equation}\label{ss:perturbation}
We will use perturbation theory to arrive at the linear wave equation from our governing equations.
%
First, we consider air at rest:
  \[ \rho = \rho_0,~ p = p_0,~ \vec{u} = \vec{0}.
  \]
%
We can think of an acoustic wave as a small perturbation of this rest state. Let $\epsilon << 1$, then we can express $\rho$, $p$ and $\vec{u}$ after this small perturbation as follows:
  \begin{gather}\label{eq:perturbed_state}
    \rho = \rho_0 +\epsilon \tilde{\rho},~
    p = p_0 + \epsilon \tilde{p},~
    \vec{u} = \epsilon \vec{\tilde{u}}.
  \end{gather}
%
To derive our wave equation, we can input \eqref{eq:perturbed_state} into \eqref{eq:euler_momentum} and \eqref{eq:ns_continuity}. \par
%
%----------------- perturbed momentum eq ------------------------
From \eqref{eq:euler_momentum} we get
    \begin{equation*}
        (\rho_0 + \epsilon\tilde{\rho})
        \left(
        \partialfrac{(\epsilon \tilde{\vec{u}})}{t} + (\epsilon\tilde{\vec{u}} \cdot \nabla)(\epsilon\tilde{\vec{u}})
        \right)
        = - \nabla (p_0 + \epsilon\tilde{p}).
    \end{equation*}
%
Since $\epsilon$ is small, all terms of order $\epsilon^2$ or smaller are negligible. Hence we are left with
    \begin{equation}\label{eq:perturbed_momentum}
        \rho_0 \partialfrac{\tilde{\vec{u}}}{t} = - \nabla \tilde{p}.
    \end{equation}
%
%---------------- perturbed continuity eq -----------------------
From \eqref{eq:ns_continuity} we get
    \begin{equation*}
        \partialfrac{}{t}(\rho_0 + \epsilon\tilde{\rho}) + (\rho_0 + \epsilon\tilde{\rho})(\nabla \cdot (\epsilon\tilde{\vec{u}})) + (\epsilon\tilde{\vec{u}} \cdot \nabla) (\rho_0 + \epsilon\tilde{\rho}).
    \end{equation*}
%
Since $\epsilon<<1$, we are left with
    \begin{equation}\label{eq:perturbed_continuity}
        \partialfrac{\tilde{\rho}}{t} + \rho_0 (\nabla \cdot \tilde{\vec{u}}) = 0.
    \end{equation}
%
%-------- differentiating perturbed continuity eq ------------
Differentiating \eqref{eq:perturbed_continuity} by $t$:
    \begin{equation*}
        \partialfrac{^2 \tilde{\rho}}{t^2} + \rho_0 \partialfrac{}{t}(\nabla \cdot \tilde{\vec{u}}) = 0
    \end{equation*}
    \begin{equation}
        \partialfrac{^2 \tilde{\rho}}{t^2}
        + \rho_0 \nabla \cdot \partialfrac{\tilde{\vec{u}}}{t} = 0.
    \end{equation}
%
Since we assumed the flow is barotropic (assumption \ref{assumption:barotropic}), we can express $p$ as a funcion of $\rho$ only. Let
    \begin{equation}\label{eq:defn_f}
         p = f(\rho).
    \end{equation}
%
From \eqref{eq:perturbed_state}, we have that $\rho = \rho_0 + \epsilon \tilde{\rho}$. Hence
    \begin{equation*}
        p = f(\rho_0 + \epsilon\tilde{\rho}).
    \end{equation*}
%
We can now expand this around the point $\rho_0$ using Taylor series.
    \begin{align*}
        p &= f(\rho) \\
        & = f(\rho_0) + f'(\rho_0)(\rho - \rho_0) + \frac{1}{2!}f''(\rho_0)(\rho - \rho_0) + \dotsb \\
        &= f(\rho_0) + \epsilon \tilde{\rho}f'(\rho_0) + O(\epsilon^2)\\
    \end{align*}
%
Hence, since $\epsilon << 1$:
    \begin{equation}\label{eq:barotropic_taylor}
        p = p_0 + \epsilon \tilde{\rho}f'(\rho_0)
    \end{equation}
%
But from \eqref{eq:perturbed_state} we have that $p = p_0 + \epsilon \tilde{p}$, and so $p_0 = p - \epsilon\tilde{p}$. Then from \eqref{eq:barotropic_taylor} we get:
    \begin{equation}\label{eq:barotropic_condition}
        \tilde{p} = \tilde{\rho} f'(\rho_0).
    \end{equation}
Since $\tilde{p}, \tilde{\rho} \geq 0$, we can assume $f'(\rho_0) \geq 0$. This will become useful in the next section.\par
%
From equation \eqref{eq:perturbed_momentum} we have
\begin{equation*}
    \partialfrac{\tilde{\vec{u}}}{t} = - \frac{1}{\rho_0} \nabla \tilde{p},
\end{equation*}
and we can substitute this into \eqref{eq:perturbed_continuity} to get:
\begin{gather*}
    \partialfrac{^2 \tilde{\rho}}{t^2}
    + \rho_0 \nabla \cdot ( \frac{- \nabla \tilde{p}}{\rho_0}) = 0 ~ \\ \partialfrac{^2 \tilde{\rho}}{t^2}
    - \nabla^2  \tilde{p} = 0.
\end{gather*}
Now we can use \ref{eq:barotropic_condition} to find an expression for $\tilde{\rho}$.
\begin{equation*}
    \partialfrac{^2 \tilde{\rho}}{t^2} - \nabla^2 (\tilde{\rho} f'(\rho_0)) = 0
\end{equation*}
Note $f'(\rho_0)$ is a positive constant, let $f'(\rho_0) = c^2$. Then:
\begin{equation}
    \partialfrac{^2 \tilde{\rho}}{t^2} = c^2 \nabla^2 \tilde{\rho}
\end{equation}
Which is the linear wave equation. We can do the same for $\tilde{p}$ and get
    \begin{equation}
        \frac{1}{c^2}\partialfrac{^2 \tilde{p}}{t^2} = \nabla^2 \tilde{p}.
    \end{equation}\par
%
Similarly,
    \begin{equation}
        \nabla^2 \vec{u} = \frac{1}{c^2} \partialfrac{^2 \vec{u}}{t^2}.
    \end{equation} \par
%
We are looking for a scalar potential such that
\begin{equation}
    \vec{u}(x, y, z, t) = \nabla \phi(x, y, z, t),
\end{equation}\par
that is, $\vec{u}$ is irrotational.
%
%-------------- prop: potential satisfies linear wave eqtn -----------
%
\begin{propn} \label{propn:potential_satisfies_linear_wave_eq}
  For a field $\vec{u}$ to satisfy the linear wave equation it is sufficient for the potential $\phi$ to satisfy the linear wave equation.
\end{propn}
\begin{proof}
  This is immediate from the definition of the velocity potiential. We assume $\vec{u}$ satisfies the linear wave equation,
  \begin{align*}
    \nabla^2 \vec{u} &= \frac{1}{c^2} \partialfrac{^2 \vec{u}}{t^2},\\
    \Leftrightarrow \nabla^2 (\nabla \phi) &= \frac{1}{c^2} \partialfrac{^2 (\nabla \phi)}{t^2},\\
    \Leftrightarrow \nabla (\nabla^2 \phi) &= \nabla \left(\frac{1}{c^2} \partialfrac{^2 \phi}{t^2}\right).
  \end{align*}
  Integrating this we get
  \begin{align*}
      \nabla^2 \phi = \frac{1}{c^2} \partialfrac{^2 \phi}{t^2} + C(t).
  \end{align*}
  Let $\hat{\phi}=\phi + \int C(t) \text{d} t$. Then,
  \begin{align*}
    \nabla^2 \hat{\phi} &= \frac{1}{c^2} \partialfrac{^2 \hat{\phi}}{t^2}-C(t)+C(t),\\
    \Leftrightarrow \nabla^2 \hat{\phi} &= \frac{1}{c^2} \partialfrac{^2 \hat{\phi}}{t^2}.
  \end{align*}
  And $\nabla\hat{\phi}=\nabla\phi=\vec{u}$. Hence if a potential of $\vec{u}$ to satisfies the linear wave equation, then $\vec{u}$ does so too.
\end{proof}
%----------------------------------------------------------------
%                  speed of sound
%----------------------------------------------------------------
\section{Aside: speed of sound}\label{ss:speed_of_sound}
Earlier we set $f'(\rho_0)=c^2$. We can now show that $c$ is in fact the speed of sound in air. \par
%
By definition of $f$, we have
    \begin{equation}
         p = f(\rho) \text{, so } f'(\rho_0) = \left.\partialfrac{p}{\rho} \right|_{\rho=\rho_0}
    \end{equation} \par
%
Then, assuming motion in air is an adiabatic process,
    \begin{align*}
        c^2 &= \left. \partialfrac{p}{\rho} \right|_{\rho_0}
        = \left. \partialfrac{}{\rho} (K \rho^\gamma) \right|_{\rho_0} \\
        &= \left. (\gamma K \rho^{\gamma-1}) \right|_{\rho_0}
        = \gamma \frac{K \rho_0 ^\gamma}{\rho_0} \\
        &= \gamma \frac{p_0}{\rho_0}
    \end{align*} \par
Hence, our constant $c^2$ depends only on our initial density and initial pressure. Additionally, it has dimensions
    \begin{equation}\label{eq:adiabatic_pressure_density_relationship}
        \frac{[p]}{[\rho]} = \frac{kgm^{-1}s^{-2}}{kgm^{-3}} = (ms^{-1})^2
    \end{equation}
since $\gamma$ is a dimensionless ratio. So $c$ is indeed a speed. \par
We want to find an expression for the speed of sound in terms of variables that can be determined experimentally, so we will make use of the Ideal Gas Law (and assume that air is indeed an Ideal Gas).
\begin{law}[Ideal Gas Law]
    For an ideal gas with ideal gas constant $R$ at temperature $T_K$ measured in degrees Kelvin, the following relationship holds
        \begin{equation*}
            \frac{p}{\rho} = R T_K.
        \end{equation*}
    \end{law} \par
%
Hence, from \eqref{eq:adiabatic_pressure_density_relationship} we have
    \begin{equation}
        c^2 = \gamma R T_K.
    \end{equation}\par
These constants are well known for air: $\gamma = 1.401$ \parencite{engineering03heatratio} and $R = 287.05 ~\si{J.kg^{-1}.K^{-1}}$ \parencite{engineering03gasconstants}. So at room temperature we have
  \begin{equation*}
    c = \sqrt{1.401 \times 287.05 ~\si{J.kg^{-1}.K^{-1}} \times (273.15+20) ~\si{K}} \approx 343 ~\si{m.s^{-1}}.
  \end{equation*}
